{% extends 'view_file_base.html' %}
{% load i18n %}

{% block extra_style %}{{block.super}}
<style type="text/css">
    #office_frame {
        width: 100%;
        height: 100%;
        top: -100;
        left: 0;
        right: 0;
        bottom: 0;
        margin: 0;
        border: none;
        display: block;
    }
</style>
{% endblock %}

{% block edit_file %}
<a class="sf-btn-group-btn sf-btn-link op-icon sf2-icon-edit" href="{% url 'wopi_file_edit' repo.id %}?path={{ path|urlencode }}" id="edit" title="{% trans "Edit" %}"></a>
{% endblock %}

{% block file_view %}
    <form id="office_form" name="office_form" target="office_frame" action="{{action_url}}" method="post">
        <input name="access_token" value="{{access_token}}" type="hidden"/>
        <input name="access_token_ttl" value="{{access_token_ttl}}" type="hidden"/>
    </form>

    <span id="frameholder"></span>

    <script type="text/javascript">
        var frameholder = document.getElementById('frameholder');
        var office_frame = document.createElement('iframe');
        office_frame.name = 'office_frame';
        office_frame.id ='office_frame';
        frameholder.appendChild(office_frame);
        document.getElementById('office_form').submit();
    </script>
{% endblock %}
